<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEON BLOCK</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; margin: 0; overflow: hidden; }
        h1 { color: #00f3ff; text-shadow: 0 0 10px #00f3ff; margin: 10px 0; }
        #board { 
            display: grid; 
            grid-template-columns: repeat(8, 35px); 
            grid-template-rows: repeat(8, 35px); 
            gap: 2px; 
            background: #222; 
            padding: 5px; 
            margin: 20px auto; 
            width: fit-content;
            border: 2px solid #444;
        }
        .cell { width: 35px; height: 35px; background: #111; border: 1px solid #333; }
        #tray { display: flex; justify-content: center; gap: 15px; margin-top: 20px; min-height: 80px; }
        .p-grid { border: 2px solid transparent; padding: 5px; cursor: pointer; }
        .selected { border-color: #00f3ff; background: rgba(0, 243, 255, 0.2); }
        .block { width: 15px; height: 15px; display: inline-block; margin: 1px; }
        #score { font-size: 20px; color: #00ff99; }
    </style>
</head>
<body>

    <h1>NEON BLOCK</h1>
    <div id="score">SCORE: 0</div>
    
    <div id="board"></div>
    
    <p style="font-size: 0.8rem;">1. Clique sur une pièce | 2. Clique sur la grille</p>
    <div id="tray"></div>

<script>
const SHAPES = [ [[1,1],[1,1]], [[1,1,1]], [[1],[1],[1]], [[1]], [[1,1],[1,0]] ];
const COLORS = ['#00f3ff', '#ff0055', '#00ff99', '#ffff00', '#ff00ff'];
let boardData = Array(8).fill().map(() => Array(8).fill(0));
let selectedPiece = null;
let score = 0;

function createBoard() {
    const b = document.getElementById('board');
    b.innerHTML = '';
    for(let r=0; r<8; r++) {
        for(let c=0; c<8; c++) {
            let cell = document.createElement('div');
            cell.className = 'cell';
            cell.onclick = () => handleCellClick(r, c);
            cell.id = `r${r}c${c}`;
            b.appendChild(cell);
        }
    }
}

function spawn() {
    const t = document.getElementById('tray');
    t.innerHTML = '';
    for(let i=0; i<3; i++) {
        const s = SHAPES[Math.floor(Math.random()*SHAPES.length)];
        const col = COLORS[Math.floor(Math.random()*COLORS.length)];
        const div = document.createElement('div');
        div.className = 'p-grid';
        div.onclick = () => {
            document.querySelectorAll('.p-grid').forEach(el => el.classList.remove('selected'));
            div.classList.add('selected');
            selectedPiece = { s, col, div };
        };
        
        s.forEach(row => {
            const line = document.createElement('div');
            row.forEach(val => {
                const b = document.createElement('div');
                b.className = 'block';
                b.style.background = val ? col : 'transparent';
                line.appendChild(b);
            });
            div.appendChild(line);
        });
        t.appendChild(div);
    }
}

function handleCellClick(r, c) {
    if(!selectedPiece) return;
    const { s, col, div } = selectedPiece;
    
    // Vérifier si ça passe
    for(let i=0; i<s.length; i++) {
        for(let j=0; j<s[i].length; j++) {
            if(s[i][j]) {
                if(r+i >= 8 || c+j >= 8 || boardData[r+i][c+j]) return;
            }
        }
    }
    
    // Poser
    for(let i=0; i<s.length; i++) {
        for(let j=0; j<s[i].length; j++) {
            if(s[i][j]) {
                boardData[r+i][c+j] = col;
                document.getElementById(`r${r+i}c${c+j}`).style.background = col;
            }
        }
    }
    
    div.remove();
    selectedPiece = null;
    score += 10;
    document.getElementById('score').innerText = "SCORE: " + score;
    if(document.getElementById('tray').children.length === 0) spawn();
}

createBoard();
spawn();
</script>
</body>
</html>
